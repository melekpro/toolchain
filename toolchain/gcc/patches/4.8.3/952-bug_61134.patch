[4.7/4.8 Regression][C++11] bogus "no matching function for call..."

 http://gcc.gnu.org/bugzilla/show_bug.cgi?id=61134

--- gcc-4_8-branch/gcc/testsuite/g++.dg/cpp0x/variadic158.C	(revision 0)
+++ gcc-4_8-branch/gcc/testsuite/g++.dg/cpp0x/variadic158.C	(revision 211387)
@@ -0,0 +1,24 @@
+// PR c++/61134
+// { dg-do compile { target c++11 } }
+
+struct Base { };
+
+template <typename>
+struct Fixed {
+  typedef const char* name;
+};
+
+template <typename VT, typename... Fields>
+void New(const char* name,
+         typename Fixed<Fields>::name... field_names);
+
+template <typename VT, typename... Fields>
+void CreateMetric(const char* name,
+                  typename Fixed<Fields>::name... field_names,
+                  const Base&) { }
+
+
+void Fn()
+{
+  CreateMetric<int, const char*>("abcd", "def", Base());
+}
--- gcc-4_8-branch/gcc/cp/ChangeLog	(revision 211386)
+++ gcc-4_8-branch/gcc/cp/ChangeLog	(revision 211387)
@@ -1,3 +1,8 @@
+2014-06-02  Jason Merrill  <jason@redhat.com>
+
+	PR c++/61134
+	* pt.c (pack_deducible_p): Handle canonicalization.
+
 2014-05-22  Release Manager
 
 	* GCC 4.8.3 released.
--- gcc-4_8-branch/gcc/cp/pt.c	(revision 211386)
+++ gcc-4_8-branch/gcc/cp/pt.c	(revision 211387)
@@ -14934,7 +14934,7 @@ pack_deducible_p (tree parm, tree fn)
 	continue;
       for (packs = PACK_EXPANSION_PARAMETER_PACKS (type);
 	   packs; packs = TREE_CHAIN (packs))
-	if (TREE_VALUE (packs) == parm)
+	if (template_args_equal (TREE_VALUE (packs), parm))
 	  {
 	    /* The template parameter pack is used in a function parameter
 	       pack.  If this is the end of the parameter list, the
